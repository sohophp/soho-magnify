!function(d,c){"object"==typeof exports&&"object"==typeof module?module.exports=c(jQuery):"function"==typeof define&&define.amd?define(["jquery"],c):"object"==typeof exports?exports.SohoMagnify=c(jQuery):d.SohoMagnify=c(jQuery)}(this,function(a){var b=function(d,c){this.element=d;this.$element=a(d);this.options=this.getOptions(c);if(!this.$element.parent().hasClass("soho-magnify")){this.$element.wrap('<div class="soho-magnify" />');this.$element.parent(".soho-magnify").append('<div class="soho-magnify-large" />')}this.$magnify=this.$element.parent(".soho-magnify");this.$magnify_large=this.$element.siblings(".soho-magnify-large");var e=this.$element.attr("src");if(this.$element.data("large")){e=this.$element.data("large")}this.$magnify.css({width:this.$element.width(),height:this.$element.height(),cursor:this.options.cursor});if(this.options.glass===1){this.$magnify_large.addClass("soho-magnify-large-glass")}else{this.$magnify.css({overflow:"hidden"})}this.$element.siblings(".soho-magnify-large").css("background","url('"+e+"') no-repeat");this.$element.parent(".soho-magnify").on(this.event+"."+this.namespace,a.proxy(this.check,this)).on(this.eventOut+"."+this.namespace,a.proxy(this.check,this)).on("touchmove."+this.namespace,a.proxy(this.check,this)).on("touchend."+this.namespace,a.proxy(this.check,this))};b.prototype={element:null,$element:null,event:"mousemove",eventOut:"mouseleave",namespace:"soho-magnify",nativeWidth:0,nativeHeight:0,getOptions:function(c){c=a.extend({},{delay:0,zoom:1,glass:1,cursor:"none"},c,this.$element.data());if(c.delay&&typeof c.delay==="number"){c.delay={show:c.delay,hide:c.delay}}return c},check:function(i){var d=this,c=a(i.currentTarget),m=c.children("img"),g=c.children(".soho-magnify-large");if(!this.nativeWidth&&!this.nativeHeight){var f=new Image();f.src=m.data("large")?m.data("large"):m.attr("src");a(f).on("load",function(n){d.nativeWidth=f.width*d.options.zoom;d.nativeHeight=f.height*d.options.zoom;if(d.options.zoom===1){if(d.nativeWidth<=c.width()){d.nativeWidth*=1.5;d.nativeHeight*=1.5}}})}else{var j=c.offset(),l=i.pageX-j.left,k=i.pageY-j.top;if(l<c.width()&&k<c.height()&&l>0&&k>0){g.fadeIn(100)}else{g.fadeOut(100)}if(g.is(":visible")){let rx=Math.round(l/c.width()*this.nativeWidth-g.width()/2)*-1,ry=Math.round(k/c.height()*this.nativeHeight-g.height()/2)*-1,bgp=rx+"px "+ry+"px",px=l-g.width()/2,py=k-g.height()/2,bs=this.nativeWidth+"px "+this.nativeHeight+"px",w,h;g.css({left:px,top:py,backgroundPosition:bgp,backgroundSize:bs});if(this.options.glass===1){}else{w=this.nativeWidth;h=this.nativeHeight;g.css({width:w,height:h})}}}},destroy:function(){this.$element.parent(".soho-magnify").off(this.event+"."+this.namespace,a.proxy(this.check,this)).off(this.eventOut+"."+this.namespace,a.proxy(this.check,this)).off("touchmove."+this.namespace,a.proxy(this.check,this)).off("touchend."+this.namespace,a.proxy(this.check,this));this.$element.siblings(".soho-magnify-large").remove();this.$element.unwrap();this.$element.removeData("soho-magnify")}};a.fn.SohoMagnify=function(c){return this.each(function(){let $this=a(this),data=$this.data("soho-magnify"),options=typeof c==="object"&&c;if(!data){$this.data("soho-magnify",(data=new b(this,options)))}if(typeof c==="string"){data[c]()}})};a.fn.SohoMagnify.Constructor=b;a(window).on("load",function(){a("[data-toggle='soho-magnify']").each(function(){a(this).SohoMagnify()})});return b});